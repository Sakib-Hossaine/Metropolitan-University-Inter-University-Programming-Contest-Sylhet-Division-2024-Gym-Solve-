#include <bits/stdc++.h>
#define l1 long long
using namespace std;

int main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);

    int _ = 1;
    cin >> _;

    while(_--)
    {
        l1 n;
        cin >> n;

        l1 a[n], p[n + 1] = {0}, cou = 0;
        set<pair<l1, l1>> st;

        for(int i = 0; i < n; i++)
        {
            cin >> a[i];
            p[a[i]] = i + 1;

            if(a[i] == i + 1) cou++;
            else st.insert({i + 1, a[i]});
        }

        l1 mov = 0, ind = 0;
        vector<pair<l1, l1>> ans;
        mov = cou;
        l1 c = 0;

        while(st.size())
        {
            l1 start = p[1];
            if(a[0] == 1)
            {
                l1 val1 = (*st.begin()).first, val2 = (*st.begin()).second;
                st.erase({val1, val2});
                swap(a[val1 - 1], a[0]);
                p[a[val1 - 1]] = val1;
                p[a[0]] = 1;
                st.insert({val1, a[val1 - 1]});
                st.insert({1, a[0]});
                start = val1;
                ans.push_back({1, val1});
            }

            while(start != 1)
            {
                st.erase({start, 1});
                l1 val = p[start];
                st.erase({val, start});
                ans.push_back({min(val, start), max(val, start)});
                swap(a[val - 1], a[start - 1]);
                p[a[val - 1]] = val;
                p[a[start - 1]] = start;
                start = p[1];

                if(start != 1)
                {
                    st.insert({start, 1});
                }
                mov++;
            }
        }

        cout << ans.size() << endl;
        for(auto x : ans) cout << x.first << " " << x.second << endl;
    }
    return 0;
}
